.loading {
  height: 3px; /* smaller height */
  /* Subtle track using theme color */
  background-color: hsl(var(--primary) / 0.12);
  /* Compact width for a more eye-catching loader */
  width: clamp(120px, 35%, 260px);
  overflow: hidden;
  margin: auto;
  border-radius: 9999px; /* pill shape */
  outline: 1px solid hsl(var(--border) / 0.25); /* subtle outline */
}

.loading-bar {
  width: 100%;
  height: 100%;
  position: relative;
  border-radius: inherit;
  /* Use VS Code's default progress bar color with a sensible fallback */
  color: var(--vscode-progressBar-background, hsl(var(--primary)));
  background-color: currentColor;
  animation: indeterminateAnimation 1.1s infinite ease-in-out;
  transform-origin: 0% 50%;
  /* gentle glow to be more visually appealing */
  filter: drop-shadow(0 0 2px currentColor);
}

/* Disable animation when the bar is determinate (width is controlled inline) */
.loading-bar.determinate {
  animation: none;
  transition: width 180ms ease;
}

/* Shimmer highlight for indeterminate mode */
.loading-bar::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.35), transparent);
  mix-blend-mode: screen;
  animation: shimmer 1.1s infinite ease-in-out;
}

.loading-bar.determinate::after {
  display: none;
}

@keyframes indeterminateAnimation {
  0% {
    transform: translateX(0) scaleX(0);
  }
  50% {
    transform: translateX(0) scaleX(0.55);
  }
  100% {
    transform: translateX(100%) scaleX(0.5);
  }
}

@keyframes shimmer {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(100%);
  }
}

@media (prefers-reduced-motion: reduce) {
  .loading-bar {
    animation-duration: 2.5s;
  }
  .loading-bar::after {
    animation-duration: 2.5s;
  }
}
