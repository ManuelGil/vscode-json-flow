# ------------------------------------------------------
# pnpm repository policy
# ------------------------------------------------------
# This file defines the strict dependency management rules
# enforced by pnpm for this repository.
#
# IMPORTANT:
# - These rules are intentionally strict.
# - If something breaks, it usually reveals a real issue
#   (implicit dependency, missing declaration, bad import).
#
# This file MUST be committed to the repository.
# ------------------------------------------------------

# ------------------------------------------------------
# Lockfile enforcement
# ------------------------------------------------------
# Always require pnpm-lock.yaml to be in sync with package.json.
# Installation must fail if there is any mismatch.
#
# This guarantees reproducible installs across machines.
prefer-frozen-lockfile=true

# ------------------------------------------------------
# node_modules layout
# ------------------------------------------------------
# Use the isolated node_modules layout.
#
# Benefits:
# - Prevents hidden/implicit dependencies
# - Avoids accidental hoisting
# - Makes dependency graph explicit
# - Reduces "it works on my machine" issues
#
# This is the recommended mode for applications and extensions.
node-linker=isolated

# ------------------------------------------------------
# Lifecycle scripts
# ------------------------------------------------------
# Never run dependency lifecycle scripts automatically.
#
# Why:
# - Security (supply-chain attacks often use postinstall)
# - Reproducibility
# - Deterministic builds
#
# Scripts must be executed explicitly via `pnpm run`.
ignore-scripts=true

# ------------------------------------------------------
# Hoisting behavior
# ------------------------------------------------------
# Disable hoisting completely.
#
# pnpm already avoids hoisting by default, but this makes
# the intention explicit and self-documented.
#
# If a dependency is required, it must be declared.
shamefully-hoist=false

# ------------------------------------------------------
# Workspace behavior (if applicable)
# ------------------------------------------------------
# Prefer local workspace packages when available.
# Safe to keep even for single-package repositories.
link-workspace-packages=true
